---
import { Image } from '@astrojs/image/components';
import {
  calculateReadingTime,
  formatDate,
  formatReadingTime,
} from '@util/formatter';
import type { MarkdownInstance } from 'astro';
import type { BlogFrontmatter } from '@pages/blog.astro';
import Tags from '@components/Tags.astro';
import Clock from './Clock.astro';
import ReadingTime from './ReadingTime.astro';

interface PostsProps {
  posts: MarkdownInstance<BlogFrontmatter>[];
}

const { posts } = Astro.props as PostsProps;
---

<div
  class='px-5 max-w-4xl mx-auto sm:grid sm:grid-cols-2 xl:grid-cols-3 md:gap-8 xl:gap-10 xl:max-w-6xl'
>
  {
    posts.map(({ frontmatter, rawContent }) => (
      <div class='mx-auto w-full overflow-hidden rounded-lg m-8 transition-all transform ease-in-out xl:max-h-xl md:hover:shadow-blue md:hover:scale-105 dark:hover:bg-gray-800 md:dark:hover:shadow-none'>
        <a href={`/blog/${frontmatter.slug}`}>
          <Image
            class='cursor-pointer w-full'
            format={'avif'}
            src={frontmatter.featureImage}
            width={1920}
            height={1080}
            alt='Featured image'
          />

          <div class='px-6 py-3 space-y-2'>
            <h3 class='text-lg font-semibold md:text-2xl'>
              {frontmatter.title}
            </h3>
            <div class='flex space-x-2 items-center'>
              <div class='text-sm text-gray-700 dark:text-gray-400'>
                {formatDate(frontmatter.datePublished)}
              </div>
              <ReadingTime html={rawContent()} />
            </div>
            <div>{frontmatter.excerpt}</div>
          </div>
        </a>
        <div class='px-6 py-3'>
          <Tags tags={frontmatter.tags} />
        </div>
      </div>
    ))
  }
</div>
